"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/chat",{

/***/ "./pages/chat.js":
/*!***********************!*\
  !*** ./pages/chat.js ***!
  \***********************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   __N_SSP: function() { return /* binding */ __N_SSP; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"./node_modules/react/jsx-dev-runtime.js\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _barrel_optimize_names_FiMenu_FiSend_react_icons_fi__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! __barrel_optimize__?names=FiMenu,FiSend!=!react-icons/fi */ \"__barrel_optimize__?names=FiMenu,FiSend!=!./node_modules/react-icons/fi/index.mjs\");\n/* harmony import */ var next_auth_react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/react */ \"./node_modules/next-auth/react/index.js\");\n/* harmony import */ var next_auth_react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth_react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/router */ \"./node_modules/next/router.js\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_3__);\n// pages/chat.js\n\nvar _s = $RefreshSig$();\n\n// Example using react-icons\n\n\n\nconst Chat = ()=>{\n    _s();\n    const { data: session, status } = (0,next_auth_react__WEBPACK_IMPORTED_MODULE_2__.useSession)();\n    const router = (0,next_router__WEBPACK_IMPORTED_MODULE_3__.useRouter)();\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [input, setInput] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const chatBoxRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const currentBotMessageIdRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const accumulatedTextRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(\"\"); // Use a ref to track accumulated text across renders\n    const [isFirstMessageSent, setIsFirstMessageSent] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Redirect to login page if not authenticated\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (status === \"unauthenticated\") {\n            router.push(\"/\");\n        }\n    }, [\n        status,\n        router\n    ]);\n    // State for streaming response\n    const [streamingResponse, setStreamingResponse] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [isStreaming, setIsStreaming] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Function for sending message to chatbot API\n    const sendMessage = async ()=>{\n        if (!input.trim()) return;\n        const newUserMessage = {\n            id: Date.now(),\n            text: input,\n            sender: \"user\"\n        };\n        setMessages((prev)=>[\n                ...prev,\n                newUserMessage\n            ]);\n        setInput(\"\");\n        setIsLoading(true);\n        setError(null);\n        setStreamingResponse(\"\");\n        setIsStreaming(true);\n        accumulatedTextRef.current = \"\"; // Reset accumulated text\n        try {\n            // Create a temporary bot message for streaming\n            const tempBotId = Date.now() + 1;\n            setMessages((prev)=>[\n                    ...prev,\n                    {\n                        id: tempBotId,\n                        text: \"\",\n                        sender: \"bot\",\n                        isStreaming: true\n                    }\n                ]);\n            // Store the ID in the ref for later access\n            currentBotMessageIdRef.current = tempBotId;\n            console.log(\"Created new bot message with ID: \".concat(tempBotId));\n            // Send the request to initiate streaming\n            // Create a URL with the message as a query parameter for the POST request\n            const encodedMessage = encodeURIComponent(input);\n            // Create a proper URL for the EventSource that includes the message\n            let eventSourceUrl = \"/api/chat-stream?message=\".concat(encodedMessage, \"&t=\").concat(Date.now());\n            if (!isFirstMessageSent) {\n                eventSourceUrl += \"&startNew=true\";\n                setIsFirstMessageSent(true); // Mark that the first message has been sent\n            }\n            const eventSource = new EventSource(eventSourceUrl);\n            let connectionTimeout = null;\n            // Set a longer timeout to handle cases where the connection might hang\n            connectionTimeout = setTimeout(()=>{\n                console.log(\"Connection timeout (30s) - closing EventSource\");\n                if (eventSource.readyState !== 2) {\n                    eventSource.close();\n                    // If we have accumulated text, use it\n                    if (accumulatedTextRef.current.length > 0) {\n                        console.log(\"Using accumulated text (\".concat(accumulatedTextRef.current.length, \" chars) after timeout\"));\n                        finalizeBotMessage(accumulatedTextRef.current);\n                    } else {\n                        setError(\"Connection timed out. Please try again.\");\n                        setIsLoading(false);\n                        setIsStreaming(false);\n                    }\n                }\n            }, 30000); // 30 second timeout - give it more time\n            // Set up event handlers\n            eventSource.onmessage = (event)=>{\n                try {\n                    // Clear the timeout on any message\n                    if (connectionTimeout) {\n                        clearTimeout(connectionTimeout);\n                        connectionTimeout = setTimeout(()=>{\n                            console.log(\"Message timeout (30s) - closing EventSource\");\n                            eventSource.close();\n                            // If we have accumulated text, use it\n                            if (accumulatedTextRef.current.length > 0) {\n                                console.log(\"Using accumulated text (\".concat(accumulatedTextRef.current.length, \" chars) after message timeout\"));\n                                finalizeBotMessage(accumulatedTextRef.current);\n                            } else {\n                                setError(\"Response timed out. Please try again.\");\n                                setIsLoading(false);\n                                setIsStreaming(false);\n                            }\n                        }, 30000); // Reset timeout to 30 seconds\n                    }\n                    let data;\n                    try {\n                        data = JSON.parse(event.data);\n                    } catch (parseError) {\n                        console.error(\"Error parsing event data:\", event.data, parseError);\n                        return;\n                    }\n                    if (data.type === \"content\" && data.content) {\n                        // Accumulate the streaming text\n                        accumulatedTextRef.current += data.content;\n                        // Restore incremental updates for better UX\n                        setStreamingResponse(accumulatedTextRef.current);\n                        // Update the message incrementally for visual feedback\n                        setMessages((prev)=>{\n                            const updatedMessages = prev.map((msg)=>msg.id === currentBotMessageIdRef.current ? {\n                                    ...msg,\n                                    text: accumulatedTextRef.current,\n                                    hasEvents: accumulatedTextRef.current.includes(\"\\uD83D\\uDCC5\") || accumulatedTextRef.current.includes(\"\\uD83D\\uDCC6\")\n                                } : msg);\n                            return updatedMessages;\n                        });\n                    } else if (data.type === \"processing\") {\n                        // Handle processing state - show a processing indicator\n                        console.log(\"Processing tool calls:\", data.content);\n                        // Store the current accumulated text before processing\n                        const currentText = accumulatedTextRef.current;\n                        try {\n                            setMessages((prev)=>prev.map((msg)=>{\n                                    return msg.id === currentBotMessageIdRef.current ? {\n                                        ...msg,\n                                        text: currentText + \"\\n\\n⚙️ \" + (data.content || \"Processing...\"),\n                                        isProcessing: true\n                                    } : msg;\n                                }));\n                        } catch (stateError) {\n                            console.error(\"Error updating message state for processing:\", stateError);\n                        }\n                    } else if (data.type === \"end\") {\n                        // Streaming completed\n                        // Finalize the bot message\n                        console.log(\"End event received with accumulated text length: \".concat(accumulatedTextRef.current.length));\n                        // If we have no accumulated text but we're getting an end event,\n                        // this might be after a tool call where the connection was reset\n                        if (accumulatedTextRef.current.length === 0) {\n                            console.log(\"End event received with no accumulated text - possible tool call issue\");\n                            // Check if we have a pending message that's in processing state\n                            setMessages((prev)=>{\n                                const currentMsg = prev.find((m)=>m.id === currentBotMessageIdRef.current);\n                                if (currentMsg && currentMsg.isProcessing) {\n                                    console.log(\"Found message in processing state, keeping it visible\");\n                                    return prev.map((m)=>m.id === currentBotMessageIdRef.current ? {\n                                            ...m,\n                                            text: m.text || \"Processing your request...\",\n                                            isStreaming: false,\n                                            isProcessing: true // Keep processing indicator\n                                        } : m);\n                                }\n                                return prev;\n                            });\n                            // Don't close the connection yet, wait for more data\n                            console.log(\"Ignoring premature end event, waiting for more data\");\n                            return;\n                        }\n                        // Clear any pending timeout\n                        if (connectionTimeout) {\n                            clearTimeout(connectionTimeout);\n                            connectionTimeout = null;\n                        }\n                        // Use our helper function to finalize the message\n                        finalizeBotMessage(accumulatedTextRef.current);\n                        // Close the connection\n                        eventSource.close();\n                    } else if (data.type === \"error\") {\n                        throw new Error(data.content || \"Error in streaming response\");\n                    }\n                } catch (err) {\n                    console.error(\"Error parsing stream data:\", err);\n                    eventSource.close();\n                    // Clear any pending timeout\n                    if (connectionTimeout) {\n                        clearTimeout(connectionTimeout);\n                        connectionTimeout = null;\n                    }\n                    setError(\"Oops! Something went wrong with the streaming response.\");\n                    setIsLoading(false);\n                    setIsStreaming(false);\n                }\n            };\n            eventSource.onerror = (err)=>{\n                console.error(\"EventSource error:\", err);\n                eventSource.close();\n                // Clear any pending timeout\n                if (connectionTimeout) {\n                    clearTimeout(connectionTimeout);\n                    connectionTimeout = null;\n                }\n                // If we have accumulated text, use it despite the error\n                if (accumulatedTextRef.current.length > 0) {\n                    console.log(\"Using accumulated text (\".concat(accumulatedTextRef.current.length, \" chars) after connection error\"));\n                    finalizeBotMessage(accumulatedTextRef.current);\n                } else {\n                    setError(\"Connection error. Please try again.\");\n                    setIsLoading(false);\n                    setIsStreaming(false);\n                }\n            };\n        } catch (error) {\n            console.error(\"Error sending message:\", error);\n            setError(\"Oops! Something went wrong. Please try again.\");\n            setIsLoading(false);\n            setIsStreaming(false);\n        }\n    };\n    // Helper function to finalize the bot message with the accumulated text\n    const finalizeBotMessage = (text)=>{\n        console.log(\"Finalizing bot message with text length: \".concat(text.length));\n        // Store the text in a local variable to avoid closure issues\n        const finalText = text;\n        // Add a delay before finalizing to ensure all chunks are received\n        setTimeout(()=>{\n            // If we have text, use it\n            if (finalText && finalText.length > 0) {\n                // Update the message with the final text\n                try {\n                    setMessages((prev)=>prev.map((msg)=>msg.id === currentBotMessageIdRef.current ? {\n                                ...msg,\n                                text: finalText,\n                                isStreaming: false,\n                                isProcessing: false,\n                                hasEvents: finalText.includes(\"\\uD83D\\uDCC5\") || finalText.includes(\"\\uD83D\\uDCC6\")\n                            } : msg));\n                    console.log(\"Successfully updated message with final text\");\n                } catch (updateError) {\n                    console.error(\"Error updating message with final text:\", updateError);\n                }\n            } else {\n                // If we don't have text, show an error message\n                try {\n                    setMessages((prev)=>prev.map((msg)=>msg.id === currentBotMessageIdRef.current ? {\n                                ...msg,\n                                text: \"No response received. Please try again.\",\n                                isStreaming: false,\n                                isProcessing: false\n                            } : msg));\n                    console.log(\"Updated message with 'No response received'\");\n                } catch (errorUpdateError) {\n                    console.error(\"Error updating message with error text:\", errorUpdateError);\n                }\n            }\n            // Update state\n            setIsLoading(false);\n            setIsStreaming(false);\n        }, 3000); // Add a 3-second delay before finalizing\n    };\n    const handleInputChange = (e)=>{\n        setInput(e.target.value);\n    };\n    const handleKeyDown = (e)=>{\n        if (e.key === \"Enter\" && !e.shiftKey) {\n            e.preventDefault();\n            sendMessage();\n        }\n    };\n    // Scroll to bottom when new messages arrive\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (chatBoxRef.current) {\n            chatBoxRef.current.scrollTop = chatBoxRef.current.scrollHeight;\n        }\n    }, [\n        messages,\n        isLoading,\n        error\n    ]);\n    // Show loading state while checking authentication\n    if (status === \"loading\") {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"flex justify-center items-center h-screen text-gray-600\",\n            children: \"Loading...\"\n        }, void 0, false, {\n            fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n            lineNumber: 337,\n            columnNumber: 7\n        }, undefined);\n    }\n    // If not authenticated, don't render anything (will redirect to login)\n    if (status === \"unauthenticated\") {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"flex justify-center items-center h-screen text-gray-600\",\n            children: \"Redirecting to login...\"\n        }, void 0, false, {\n            fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n            lineNumber: 346,\n            columnNumber: 7\n        }, undefined);\n    }\n    // Only render the chat UI if authenticated\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"mt-5\",\n        children: [\n            \" \",\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex items-center mb-4 p-2 bg-white rounded-lg shadow-sm\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        className: \"text-gray-700 text-xl mr-3\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_FiMenu_FiSend_react_icons_fi__WEBPACK_IMPORTED_MODULE_4__.FiMenu, {}, void 0, false, {\n                            fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                            lineNumber: 358,\n                            columnNumber: 11\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                        lineNumber: 357,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center\",\n                        children: (session === null || session === void 0 ? void 0 : session.user) && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                    src: session.user.image,\n                                    alt: \"Profile\",\n                                    className: \"w-8 h-8 rounded-full mr-2\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                    lineNumber: 363,\n                                    columnNumber: 15\n                                }, undefined),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    className: \"text-sm font-medium text-gray-700\",\n                                    children: session.user.name\n                                }, void 0, false, {\n                                    fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                    lineNumber: 368,\n                                    columnNumber: 15\n                                }, undefined)\n                            ]\n                        }, void 0, true)\n                    }, void 0, false, {\n                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                        lineNumber: 360,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                lineNumber: 356,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                ref: chatBoxRef,\n                className: \"bg-gray-100 rounded-2xl p-5 max-h-[300px] min-h-[100px] overflow-y-auto mb-4 border border-gray-200\" // Added border\n                ,\n                children: [\n                    messages.length === 0 && !isLoading && !error && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-center text-gray-500 text-sm\",\n                        children: \"Ask me to manage your calendar events!\"\n                    }, void 0, false, {\n                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                        lineNumber: 381,\n                        columnNumber: 13\n                    }, undefined),\n                    messages.map((msg)=>// Styles previously from .message and specific types\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"mb-3 p-3 rounded-xl max-w-[80%] break-words \".concat(msg.sender === \"user\" ? \"bg-blue-500 text-white ml-auto\" // .user styles\n                             : \"bg-gray-600 text-white mr-auto\" // .bot styles \n                            , \" \").concat(msg.isStreaming ? \"border-l-4 border-yellow-400\" : \"\", \" \").concat(msg.isProcessing ? \"border-l-4 border-blue-400\" : \"\"),\n                            children: msg.hasEvents ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"whitespace-pre-wrap\",\n                                children: [\n                                    msg.text.split(\"\\n\").map((line, index)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"\".concat(line.startsWith(\"\\uD83D\\uDCC5\") || line.startsWith(\"\\uD83D\\uDCC6\") ? \"font-bold\" : \"\"),\n                                            children: line\n                                        }, index, false, {\n                                            fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                            lineNumber: 396,\n                                            columnNumber: 29\n                                        }, undefined)),\n                                    msg.isStreaming && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        className: \"inline-block w-2 h-4 ml-1 bg-yellow-400 animate-pulse\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                        lineNumber: 403,\n                                        columnNumber: 29\n                                    }, undefined),\n                                    msg.isProcessing && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        className: \"inline-block w-2 h-4 ml-1 bg-blue-400 animate-pulse\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                        lineNumber: 406,\n                                        columnNumber: 29\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                lineNumber: 394,\n                                columnNumber: 21\n                            }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"whitespace-pre-wrap\",\n                                children: [\n                                    msg.text,\n                                    msg.isStreaming && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        className: \"inline-block w-2 h-4 ml-1 bg-yellow-400 animate-pulse\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                        lineNumber: 413,\n                                        columnNumber: 29\n                                    }, undefined),\n                                    msg.isProcessing && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        className: \"inline-block w-2 h-4 ml-1 bg-blue-400 animate-pulse\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                        lineNumber: 416,\n                                        columnNumber: 29\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                lineNumber: 410,\n                                columnNumber: 21\n                            }, undefined)\n                        }, msg.id, false, {\n                            fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                            lineNumber: 385,\n                            columnNumber: 13\n                        }, undefined)),\n                    isLoading && // Styles previously from .loading and .dot\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex justify-start items-center h-10 my-2\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex space-x-1.5 p-2 bg-gray-600 rounded-full\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    className: \"w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.3s]\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                    lineNumber: 428,\n                                    columnNumber: 21\n                                }, undefined),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    className: \"w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.15s]\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                    lineNumber: 429,\n                                    columnNumber: 21\n                                }, undefined),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    className: \"w-2 h-2 bg-white rounded-full animate-bounce\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                                    lineNumber: 430,\n                                    columnNumber: 21\n                                }, undefined)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                            lineNumber: 427,\n                            columnNumber: 18\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                        lineNumber: 426,\n                        columnNumber: 13\n                    }, undefined),\n                    error && // Styles previously from .error\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"mb-3 p-3 rounded-xl max-w-[80%] bg-red-500 text-white mx-auto text-center text-sm\",\n                        children: error\n                    }, void 0, false, {\n                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                        lineNumber: 438,\n                        columnNumber: 14\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                lineNumber: 376,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-gray-100 p-2 rounded-full flex items-center transition-shadow duration-300 focus-within:ring-2 focus-within:ring-blue-500 border border-gray-200\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                        type: \"text\",\n                        placeholder: \"Ask about your calendar...\",\n                        value: input,\n                        onChange: handleInputChange,\n                        onKeyDown: handleKeyDown,\n                        disabled: isLoading,\n                        className: \"bg-transparent border-none text-gray-800 flex-grow text-base p-2 outline-none placeholder-gray-500 disabled:opacity-60\"\n                    }, void 0, false, {\n                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                        lineNumber: 447,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: sendMessage,\n                        disabled: isLoading || !input.trim(),\n                        className: \"text-2xl p-2 rounded-full text-blue-500 bg-transparent border-none transition-transform duration-300 hover:scale-110 hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:hover:bg-transparent\",\n                        \"aria-label\": \"Send message\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_FiMenu_FiSend_react_icons_fi__WEBPACK_IMPORTED_MODULE_4__.FiSend, {}, void 0, false, {\n                            fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                            lineNumber: 463,\n                            columnNumber: 11\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                        lineNumber: 457,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n                lineNumber: 445,\n                columnNumber: 7\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"/Users/ahnafahsan/Desktop/GCalendarApp/pages/chat.js\",\n        lineNumber: 354,\n        columnNumber: 5\n    }, undefined);\n};\n_s(Chat, \"SE9eIXFFhQDyp/2/p+3ggEPwcFY=\", false, function() {\n    return [\n        next_auth_react__WEBPACK_IMPORTED_MODULE_2__.useSession,\n        next_router__WEBPACK_IMPORTED_MODULE_3__.useRouter\n    ];\n});\n_c = Chat;\nvar __N_SSP = true;\n/* harmony default export */ __webpack_exports__[\"default\"] = (Chat);\nvar _c;\n$RefreshReg$(_c, \"Chat\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTFjTUk7O1FBQzhCRix1REFBVUE7UUFDN0JDLGtEQUFTQTs7O0tBRnBCQzs7QUE0Y04sK0RBQWVBLElBQUlBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vcGFnZXMvY2hhdC5qcz80Y2M5Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHBhZ2VzL2NoYXQuanNcbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG4vLyBFeGFtcGxlIHVzaW5nIHJlYWN0LWljb25zXG5pbXBvcnQgeyBGaVNlbmQsIEZpTWVudSB9IGZyb20gJ3JlYWN0LWljb25zL2ZpJztcbmltcG9ydCB7IHVzZVNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgvcmVhY3QnO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9yb3V0ZXInO1xuaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gJ25leHQtYXV0aC9uZXh0JztcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnLi9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdJztcblxuY29uc3QgQ2hhdCA9ICgpID0+IHtcbiAgY29uc3QgeyBkYXRhOiBzZXNzaW9uLCBzdGF0dXMgfSA9IHVzZVNlc3Npb24oKTtcbiAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XG4gIGNvbnN0IFttZXNzYWdlcywgc2V0TWVzc2FnZXNdID0gdXNlU3RhdGUoW10pO1xuICBjb25zdCBbaW5wdXQsIHNldElucHV0XSA9IHVzZVN0YXRlKCcnKTtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZShudWxsKTtcbiAgY29uc3QgY2hhdEJveFJlZiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgY3VycmVudEJvdE1lc3NhZ2VJZFJlZiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgYWNjdW11bGF0ZWRUZXh0UmVmID0gdXNlUmVmKCcnKTsgLy8gVXNlIGEgcmVmIHRvIHRyYWNrIGFjY3VtdWxhdGVkIHRleHQgYWNyb3NzIHJlbmRlcnNcbiAgY29uc3QgW2lzRmlyc3RNZXNzYWdlU2VudCwgc2V0SXNGaXJzdE1lc3NhZ2VTZW50XSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgXG4gIC8vIFJlZGlyZWN0IHRvIGxvZ2luIHBhZ2UgaWYgbm90IGF1dGhlbnRpY2F0ZWRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoc3RhdHVzID09PSAndW5hdXRoZW50aWNhdGVkJykge1xuICAgICAgcm91dGVyLnB1c2goJy8nKTtcbiAgICB9XG4gIH0sIFtzdGF0dXMsIHJvdXRlcl0pO1xuXG4gIC8vIFN0YXRlIGZvciBzdHJlYW1pbmcgcmVzcG9uc2VcbiAgY29uc3QgW3N0cmVhbWluZ1Jlc3BvbnNlLCBzZXRTdHJlYW1pbmdSZXNwb25zZV0gPSB1c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IFtpc1N0cmVhbWluZywgc2V0SXNTdHJlYW1pbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBcbiAgLy8gRnVuY3Rpb24gZm9yIHNlbmRpbmcgbWVzc2FnZSB0byBjaGF0Ym90IEFQSVxuICBjb25zdCBzZW5kTWVzc2FnZSA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWlucHV0LnRyaW0oKSkgcmV0dXJuO1xuXG4gICAgY29uc3QgbmV3VXNlck1lc3NhZ2UgPSB7IGlkOiBEYXRlLm5vdygpLCB0ZXh0OiBpbnB1dCwgc2VuZGVyOiAndXNlcicgfTtcbiAgICBzZXRNZXNzYWdlcygocHJldikgPT4gWy4uLnByZXYsIG5ld1VzZXJNZXNzYWdlXSk7XG4gICAgc2V0SW5wdXQoJycpO1xuICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICBzZXRFcnJvcihudWxsKTtcbiAgICBzZXRTdHJlYW1pbmdSZXNwb25zZSgnJyk7IFxuICAgIHNldElzU3RyZWFtaW5nKHRydWUpO1xuICAgIGFjY3VtdWxhdGVkVGV4dFJlZi5jdXJyZW50ID0gJyc7IC8vIFJlc2V0IGFjY3VtdWxhdGVkIHRleHRcblxuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgYSB0ZW1wb3JhcnkgYm90IG1lc3NhZ2UgZm9yIHN0cmVhbWluZ1xuICAgICAgY29uc3QgdGVtcEJvdElkID0gRGF0ZS5ub3coKSArIDE7XG4gICAgICBzZXRNZXNzYWdlcygocHJldikgPT4gWy4uLnByZXYsIHtcbiAgICAgICAgaWQ6IHRlbXBCb3RJZCxcbiAgICAgICAgdGV4dDogJycsXG4gICAgICAgIHNlbmRlcjogJ2JvdCcsXG4gICAgICAgIGlzU3RyZWFtaW5nOiB0cnVlXG4gICAgICB9XSk7XG4gICAgICBcbiAgICAgIC8vIFN0b3JlIHRoZSBJRCBpbiB0aGUgcmVmIGZvciBsYXRlciBhY2Nlc3NcbiAgICAgIGN1cnJlbnRCb3RNZXNzYWdlSWRSZWYuY3VycmVudCA9IHRlbXBCb3RJZDtcbiAgICAgIGNvbnNvbGUubG9nKGBDcmVhdGVkIG5ldyBib3QgbWVzc2FnZSB3aXRoIElEOiAke3RlbXBCb3RJZH1gKTtcbiAgICAgIC8vIFNlbmQgdGhlIHJlcXVlc3QgdG8gaW5pdGlhdGUgc3RyZWFtaW5nXG4gICAgICAvLyBDcmVhdGUgYSBVUkwgd2l0aCB0aGUgbWVzc2FnZSBhcyBhIHF1ZXJ5IHBhcmFtZXRlciBmb3IgdGhlIFBPU1QgcmVxdWVzdFxuICAgICAgY29uc3QgZW5jb2RlZE1lc3NhZ2UgPSBlbmNvZGVVUklDb21wb25lbnQoaW5wdXQpO1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgYSBwcm9wZXIgVVJMIGZvciB0aGUgRXZlbnRTb3VyY2UgdGhhdCBpbmNsdWRlcyB0aGUgbWVzc2FnZVxuICAgICAgbGV0IGV2ZW50U291cmNlVXJsID0gYC9hcGkvY2hhdC1zdHJlYW0/bWVzc2FnZT0ke2VuY29kZWRNZXNzYWdlfSZ0PSR7RGF0ZS5ub3coKX1gO1xuICAgICAgaWYgKCFpc0ZpcnN0TWVzc2FnZVNlbnQpIHtcbiAgICAgICAgZXZlbnRTb3VyY2VVcmwgKz0gJyZzdGFydE5ldz10cnVlJztcbiAgICAgICAgc2V0SXNGaXJzdE1lc3NhZ2VTZW50KHRydWUpOyAvLyBNYXJrIHRoYXQgdGhlIGZpcnN0IG1lc3NhZ2UgaGFzIGJlZW4gc2VudFxuICAgICAgfVxuICAgICAgY29uc3QgZXZlbnRTb3VyY2UgPSBuZXcgRXZlbnRTb3VyY2UoZXZlbnRTb3VyY2VVcmwpO1xuICAgICAgbGV0IGNvbm5lY3Rpb25UaW1lb3V0ID0gbnVsbDtcbiAgICAgIFxuICAgICAgLy8gU2V0IGEgbG9uZ2VyIHRpbWVvdXQgdG8gaGFuZGxlIGNhc2VzIHdoZXJlIHRoZSBjb25uZWN0aW9uIG1pZ2h0IGhhbmdcbiAgICAgIGNvbm5lY3Rpb25UaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ29ubmVjdGlvbiB0aW1lb3V0ICgzMHMpIC0gY2xvc2luZyBFdmVudFNvdXJjZVwiKTtcbiAgICAgICAgaWYgKGV2ZW50U291cmNlLnJlYWR5U3RhdGUgIT09IDIpIHsgLy8gMiA9IENMT1NFRFxuICAgICAgICAgIGV2ZW50U291cmNlLmNsb3NlKCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gSWYgd2UgaGF2ZSBhY2N1bXVsYXRlZCB0ZXh0LCB1c2UgaXRcbiAgICAgICAgICBpZiAoYWNjdW11bGF0ZWRUZXh0UmVmLmN1cnJlbnQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFVzaW5nIGFjY3VtdWxhdGVkIHRleHQgKCR7YWNjdW11bGF0ZWRUZXh0UmVmLmN1cnJlbnQubGVuZ3RofSBjaGFycykgYWZ0ZXIgdGltZW91dGApO1xuICAgICAgICAgICAgZmluYWxpemVCb3RNZXNzYWdlKGFjY3VtdWxhdGVkVGV4dFJlZi5jdXJyZW50KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0RXJyb3IoXCJDb25uZWN0aW9uIHRpbWVkIG91dC4gUGxlYXNlIHRyeSBhZ2Fpbi5cIik7XG4gICAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgc2V0SXNTdHJlYW1pbmcoZmFsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgMzAwMDApOyAvLyAzMCBzZWNvbmQgdGltZW91dCAtIGdpdmUgaXQgbW9yZSB0aW1lXG4gICAgICBcbiAgICAgIC8vIFNldCB1cCBldmVudCBoYW5kbGVyc1xuICAgICAgZXZlbnRTb3VyY2Uub25tZXNzYWdlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gQ2xlYXIgdGhlIHRpbWVvdXQgb24gYW55IG1lc3NhZ2VcbiAgICAgICAgICBpZiAoY29ubmVjdGlvblRpbWVvdXQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChjb25uZWN0aW9uVGltZW91dCk7XG4gICAgICAgICAgICBjb25uZWN0aW9uVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1lc3NhZ2UgdGltZW91dCAoMzBzKSAtIGNsb3NpbmcgRXZlbnRTb3VyY2VcIik7XG4gICAgICAgICAgICAgIGV2ZW50U291cmNlLmNsb3NlKCk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGFjY3VtdWxhdGVkIHRleHQsIHVzZSBpdFxuICAgICAgICAgICAgICBpZiAoYWNjdW11bGF0ZWRUZXh0UmVmLmN1cnJlbnQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVc2luZyBhY2N1bXVsYXRlZCB0ZXh0ICgke2FjY3VtdWxhdGVkVGV4dFJlZi5jdXJyZW50Lmxlbmd0aH0gY2hhcnMpIGFmdGVyIG1lc3NhZ2UgdGltZW91dGApO1xuICAgICAgICAgICAgICAgIGZpbmFsaXplQm90TWVzc2FnZShhY2N1bXVsYXRlZFRleHRSZWYuY3VycmVudCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0RXJyb3IoXCJSZXNwb25zZSB0aW1lZCBvdXQuIFBsZWFzZSB0cnkgYWdhaW4uXCIpO1xuICAgICAgICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgc2V0SXNTdHJlYW1pbmcoZmFsc2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAzMDAwMCk7IC8vIFJlc2V0IHRpbWVvdXQgdG8gMzAgc2Vjb25kc1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICBsZXQgZGF0YTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XG4gICAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHBhcnNpbmcgZXZlbnQgZGF0YTpcIiwgZXZlbnQuZGF0YSwgcGFyc2VFcnJvcik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChkYXRhLnR5cGUgPT09ICdjb250ZW50JyAmJiBkYXRhLmNvbnRlbnQpIHtcbiAgICAgICAgICAgIC8vIEFjY3VtdWxhdGUgdGhlIHN0cmVhbWluZyB0ZXh0XG4gICAgICAgICAgICBhY2N1bXVsYXRlZFRleHRSZWYuY3VycmVudCArPSBkYXRhLmNvbnRlbnQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJlc3RvcmUgaW5jcmVtZW50YWwgdXBkYXRlcyBmb3IgYmV0dGVyIFVYXG4gICAgICAgICAgICBzZXRTdHJlYW1pbmdSZXNwb25zZShhY2N1bXVsYXRlZFRleHRSZWYuY3VycmVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbWVzc2FnZSBpbmNyZW1lbnRhbGx5IGZvciB2aXN1YWwgZmVlZGJhY2tcbiAgICAgICAgICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRNZXNzYWdlcyA9IHByZXYubWFwKG1zZyA9PlxuICAgICAgICAgICAgICAgIG1zZy5pZCA9PT0gY3VycmVudEJvdE1lc3NhZ2VJZFJlZi5jdXJyZW50XG4gICAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAuLi5tc2csXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dDogYWNjdW11bGF0ZWRUZXh0UmVmLmN1cnJlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgaGFzRXZlbnRzOiBhY2N1bXVsYXRlZFRleHRSZWYuY3VycmVudC5pbmNsdWRlcygn8J+ThScpIHx8IGFjY3VtdWxhdGVkVGV4dFJlZi5jdXJyZW50LmluY2x1ZGVzKCfwn5OGJylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgOiBtc2dcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRNZXNzYWdlcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSAncHJvY2Vzc2luZycpIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBwcm9jZXNzaW5nIHN0YXRlIC0gc2hvdyBhIHByb2Nlc3NpbmcgaW5kaWNhdG9yXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlByb2Nlc3NpbmcgdG9vbCBjYWxsczpcIiwgZGF0YS5jb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIGN1cnJlbnQgYWNjdW11bGF0ZWQgdGV4dCBiZWZvcmUgcHJvY2Vzc2luZ1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFRleHQgPSBhY2N1bXVsYXRlZFRleHRSZWYuY3VycmVudDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+XG4gICAgICAgICAgICAgICAgcHJldi5tYXAobXNnID0+IHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICBtc2cuaWQgPT09IGN1cnJlbnRCb3RNZXNzYWdlSWRSZWYuY3VycmVudFxuICAgICAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLm1zZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGN1cnJlbnRUZXh0ICsgXCJcXG5cXG7impnvuI8gXCIgKyAoZGF0YS5jb250ZW50IHx8IFwiUHJvY2Vzc2luZy4uLlwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUHJvY2Vzc2luZzogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiBtc2dcbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHN0YXRlRXJyb3IpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIG1lc3NhZ2Ugc3RhdGUgZm9yIHByb2Nlc3Npbmc6XCIsIHN0YXRlRXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSAnZW5kJykge1xuICAgICAgICAgICAgLy8gU3RyZWFtaW5nIGNvbXBsZXRlZFxuICAgICAgICAgICAgLy8gRmluYWxpemUgdGhlIGJvdCBtZXNzYWdlXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRW5kIGV2ZW50IHJlY2VpdmVkIHdpdGggYWNjdW11bGF0ZWQgdGV4dCBsZW5ndGg6ICR7YWNjdW11bGF0ZWRUZXh0UmVmLmN1cnJlbnQubGVuZ3RofWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIG5vIGFjY3VtdWxhdGVkIHRleHQgYnV0IHdlJ3JlIGdldHRpbmcgYW4gZW5kIGV2ZW50LFxuICAgICAgICAgICAgLy8gdGhpcyBtaWdodCBiZSBhZnRlciBhIHRvb2wgY2FsbCB3aGVyZSB0aGUgY29ubmVjdGlvbiB3YXMgcmVzZXRcbiAgICAgICAgICAgIGlmIChhY2N1bXVsYXRlZFRleHRSZWYuY3VycmVudC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFbmQgZXZlbnQgcmVjZWl2ZWQgd2l0aCBubyBhY2N1bXVsYXRlZCB0ZXh0IC0gcG9zc2libGUgdG9vbCBjYWxsIGlzc3VlXCIpO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhIHBlbmRpbmcgbWVzc2FnZSB0aGF0J3MgaW4gcHJvY2Vzc2luZyBzdGF0ZVxuICAgICAgICAgICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TXNnID0gcHJldi5maW5kKG0gPT4gbS5pZCA9PT0gY3VycmVudEJvdE1lc3NhZ2VJZFJlZi5jdXJyZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1zZyAmJiBjdXJyZW50TXNnLmlzUHJvY2Vzc2luZykge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGb3VuZCBtZXNzYWdlIGluIHByb2Nlc3Npbmcgc3RhdGUsIGtlZXBpbmcgaXQgdmlzaWJsZVwiKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBwcmV2Lm1hcChtID0+IFxuICAgICAgICAgICAgICAgICAgICBtLmlkID09PSBjdXJyZW50Qm90TWVzc2FnZUlkUmVmLmN1cnJlbnRcbiAgICAgICAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLi4ubSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbS50ZXh0IHx8IFwiUHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuLi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTdHJlYW1pbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBpc1Byb2Nlc3Npbmc6IHRydWUgLy8gS2VlcCBwcm9jZXNzaW5nIGluZGljYXRvclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIDogbVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgLy8gRG9uJ3QgY2xvc2UgdGhlIGNvbm5lY3Rpb24geWV0LCB3YWl0IGZvciBtb3JlIGRhdGFcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJZ25vcmluZyBwcmVtYXR1cmUgZW5kIGV2ZW50LCB3YWl0aW5nIGZvciBtb3JlIGRhdGFcIik7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgICAgIC8vIENsZWFyIGFueSBwZW5kaW5nIHRpbWVvdXRcbiAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25UaW1lb3V0KSB7XG4gICAgICAgICAgICAgIGNsZWFyVGltZW91dChjb25uZWN0aW9uVGltZW91dCk7XG4gICAgICAgICAgICAgIGNvbm5lY3Rpb25UaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXNlIG91ciBoZWxwZXIgZnVuY3Rpb24gdG8gZmluYWxpemUgdGhlIG1lc3NhZ2VcbiAgICAgICAgICAgIGZpbmFsaXplQm90TWVzc2FnZShhY2N1bXVsYXRlZFRleHRSZWYuY3VycmVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgLy8gQ2xvc2UgdGhlIGNvbm5lY3Rpb25cbiAgICAgICAgICAgIGV2ZW50U291cmNlLmNsb3NlKCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhLmNvbnRlbnQgfHwgJ0Vycm9yIGluIHN0cmVhbWluZyByZXNwb25zZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBzdHJlYW0gZGF0YTonLCBlcnIpO1xuICAgICAgICAgIGV2ZW50U291cmNlLmNsb3NlKCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQ2xlYXIgYW55IHBlbmRpbmcgdGltZW91dFxuICAgICAgICAgIGlmIChjb25uZWN0aW9uVGltZW91dCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGNvbm5lY3Rpb25UaW1lb3V0KTtcbiAgICAgICAgICAgIGNvbm5lY3Rpb25UaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICBzZXRFcnJvcihcIk9vcHMhIFNvbWV0aGluZyB3ZW50IHdyb25nIHdpdGggdGhlIHN0cmVhbWluZyByZXNwb25zZS5cIik7XG4gICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICBzZXRJc1N0cmVhbWluZyhmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGV2ZW50U291cmNlLm9uZXJyb3IgPSAoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0V2ZW50U291cmNlIGVycm9yOicsIGVycik7XG4gICAgICAgIGV2ZW50U291cmNlLmNsb3NlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhciBhbnkgcGVuZGluZyB0aW1lb3V0XG4gICAgICAgIGlmIChjb25uZWN0aW9uVGltZW91dCkge1xuICAgICAgICAgIGNsZWFyVGltZW91dChjb25uZWN0aW9uVGltZW91dCk7XG4gICAgICAgICAgY29ubmVjdGlvblRpbWVvdXQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJZiB3ZSBoYXZlIGFjY3VtdWxhdGVkIHRleHQsIHVzZSBpdCBkZXNwaXRlIHRoZSBlcnJvclxuICAgICAgICBpZiAoYWNjdW11bGF0ZWRUZXh0UmVmLmN1cnJlbnQubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBVc2luZyBhY2N1bXVsYXRlZCB0ZXh0ICgke2FjY3VtdWxhdGVkVGV4dFJlZi5jdXJyZW50Lmxlbmd0aH0gY2hhcnMpIGFmdGVyIGNvbm5lY3Rpb24gZXJyb3JgKTtcbiAgICAgICAgICBmaW5hbGl6ZUJvdE1lc3NhZ2UoYWNjdW11bGF0ZWRUZXh0UmVmLmN1cnJlbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNldEVycm9yKFwiQ29ubmVjdGlvbiBlcnJvci4gUGxlYXNlIHRyeSBhZ2Fpbi5cIik7XG4gICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICBzZXRJc1N0cmVhbWluZyhmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBtZXNzYWdlOicsIGVycm9yKTtcbiAgICAgIHNldEVycm9yKFwiT29wcyEgU29tZXRoaW5nIHdlbnQgd3JvbmcuIFBsZWFzZSB0cnkgYWdhaW4uXCIpO1xuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgIHNldElzU3RyZWFtaW5nKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGZpbmFsaXplIHRoZSBib3QgbWVzc2FnZSB3aXRoIHRoZSBhY2N1bXVsYXRlZCB0ZXh0XG4gIGNvbnN0IGZpbmFsaXplQm90TWVzc2FnZSA9ICh0ZXh0KSA9PiB7XG4gICAgY29uc29sZS5sb2coYEZpbmFsaXppbmcgYm90IG1lc3NhZ2Ugd2l0aCB0ZXh0IGxlbmd0aDogJHt0ZXh0Lmxlbmd0aH1gKTtcbiAgICBcbiAgICAvLyBTdG9yZSB0aGUgdGV4dCBpbiBhIGxvY2FsIHZhcmlhYmxlIHRvIGF2b2lkIGNsb3N1cmUgaXNzdWVzXG4gICAgY29uc3QgZmluYWxUZXh0ID0gdGV4dDtcblxuICAgIC8vIEFkZCBhIGRlbGF5IGJlZm9yZSBmaW5hbGl6aW5nIHRvIGVuc3VyZSBhbGwgY2h1bmtzIGFyZSByZWNlaXZlZFxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gSWYgd2UgaGF2ZSB0ZXh0LCB1c2UgaXRcbiAgICAgIGlmIChmaW5hbFRleHQgJiYgZmluYWxUZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gVXBkYXRlIHRoZSBtZXNzYWdlIHdpdGggdGhlIGZpbmFsIHRleHRcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IFxuICAgICAgICAgICAgcHJldi5tYXAobXNnID0+IFxuICAgICAgICAgICAgICBtc2cuaWQgPT09IGN1cnJlbnRCb3RNZXNzYWdlSWRSZWYuY3VycmVudCBcbiAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ubXNnLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBmaW5hbFRleHQsXG4gICAgICAgICAgICAgICAgICAgIGlzU3RyZWFtaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaXNQcm9jZXNzaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaGFzRXZlbnRzOiBmaW5hbFRleHQuaW5jbHVkZXMoJ/Cfk4UnKSB8fCBmaW5hbFRleHQuaW5jbHVkZXMoJ/Cfk4YnKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDogbXNnXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlN1Y2Nlc3NmdWxseSB1cGRhdGVkIG1lc3NhZ2Ugd2l0aCBmaW5hbCB0ZXh0XCIpO1xuICAgICAgICB9IGNhdGNoICh1cGRhdGVFcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBtZXNzYWdlIHdpdGggZmluYWwgdGV4dDpcIiwgdXBkYXRlRXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIHRleHQsIHNob3cgYW4gZXJyb3IgbWVzc2FnZVxuICAgICAgICB0cnkge1xuICAgICAgICAgIHNldE1lc3NhZ2VzKHByZXYgPT4gXG4gICAgICAgICAgICBwcmV2Lm1hcChtc2cgPT4gXG4gICAgICAgICAgICAgIG1zZy5pZCA9PT0gY3VycmVudEJvdE1lc3NhZ2VJZFJlZi5jdXJyZW50IFxuICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAuLi5tc2csXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiTm8gcmVzcG9uc2UgcmVjZWl2ZWQuIFBsZWFzZSB0cnkgYWdhaW4uXCIsXG4gICAgICAgICAgICAgICAgICAgIGlzU3RyZWFtaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaXNQcm9jZXNzaW5nOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDogbXNnXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0ZWQgbWVzc2FnZSB3aXRoICdObyByZXNwb25zZSByZWNlaXZlZCdcIik7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yVXBkYXRlRXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgbWVzc2FnZSB3aXRoIGVycm9yIHRleHQ6XCIsIGVycm9yVXBkYXRlRXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFVwZGF0ZSBzdGF0ZVxuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgIHNldElzU3RyZWFtaW5nKGZhbHNlKTtcbiAgICB9LCAzMDAwKTsgLy8gQWRkIGEgMy1zZWNvbmQgZGVsYXkgYmVmb3JlIGZpbmFsaXppbmdcbiAgfTtcblxuICBjb25zdCBoYW5kbGVJbnB1dENoYW5nZSA9IChlKSA9PiB7XG4gICAgc2V0SW5wdXQoZS50YXJnZXQudmFsdWUpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZUtleURvd24gPSAoZSkgPT4ge1xuICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiAhZS5zaGlmdEtleSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgc2VuZE1lc3NhZ2UoKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gU2Nyb2xsIHRvIGJvdHRvbSB3aGVuIG5ldyBtZXNzYWdlcyBhcnJpdmVcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoY2hhdEJveFJlZi5jdXJyZW50KSB7XG4gICAgICBjaGF0Qm94UmVmLmN1cnJlbnQuc2Nyb2xsVG9wID0gY2hhdEJveFJlZi5jdXJyZW50LnNjcm9sbEhlaWdodDtcbiAgICB9XG4gIH0sIFttZXNzYWdlcywgaXNMb2FkaW5nLCBlcnJvcl0pO1xuXG5cbiAgLy8gU2hvdyBsb2FkaW5nIHN0YXRlIHdoaWxlIGNoZWNraW5nIGF1dGhlbnRpY2F0aW9uXG4gIGlmIChzdGF0dXMgPT09ICdsb2FkaW5nJykge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1jZW50ZXIgaXRlbXMtY2VudGVyIGgtc2NyZWVuIHRleHQtZ3JheS02MDBcIj5cbiAgICAgICAgTG9hZGluZy4uLlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuICBcbiAgLy8gSWYgbm90IGF1dGhlbnRpY2F0ZWQsIGRvbid0IHJlbmRlciBhbnl0aGluZyAod2lsbCByZWRpcmVjdCB0byBsb2dpbilcbiAgaWYgKHN0YXR1cyA9PT0gJ3VuYXV0aGVudGljYXRlZCcpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlciBoLXNjcmVlbiB0ZXh0LWdyYXktNjAwXCI+XG4gICAgICAgIFJlZGlyZWN0aW5nIHRvIGxvZ2luLi4uXG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG4gIFxuICAvLyBPbmx5IHJlbmRlciB0aGUgY2hhdCBVSSBpZiBhdXRoZW50aWNhdGVkXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJtdC01XCI+IHsvKiBDb250YWluZXIgZm9yIGNoYXQgaW50ZXJmYWNlICovfVxuICAgICAgey8qIEhhbWJ1cmdlciBtZW51IHdpdGggcHJvZmlsZSBwaWN0dXJlIGFuZCBHb29nbGUgYWNjb3VudCBuYW1lICovfVxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBtYi00IHAtMiBiZy13aGl0ZSByb3VuZGVkLWxnIHNoYWRvdy1zbVwiPlxuICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cInRleHQtZ3JheS03MDAgdGV4dC14bCBtci0zXCI+XG4gICAgICAgICAgPEZpTWVudSAvPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgIHtzZXNzaW9uPy51c2VyICYmIChcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgIDxpbWdcbiAgICAgICAgICAgICAgICBzcmM9e3Nlc3Npb24udXNlci5pbWFnZX1cbiAgICAgICAgICAgICAgICBhbHQ9XCJQcm9maWxlXCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTggaC04IHJvdW5kZWQtZnVsbCBtci0yXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LWdyYXktNzAwXCI+XG4gICAgICAgICAgICAgICAge3Nlc3Npb24udXNlci5uYW1lfVxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgey8qIFN0eWxlcyBwcmV2aW91c2x5IGZyb20gI2NoYXQtYm94ICovfVxuICAgICAgPGRpdlxuICAgICAgICByZWY9e2NoYXRCb3hSZWZ9XG4gICAgICAgIGNsYXNzTmFtZT1cImJnLWdyYXktMTAwIHJvdW5kZWQtMnhsIHAtNSBtYXgtaC1bMzAwcHhdIG1pbi1oLVsxMDBweF0gb3ZlcmZsb3cteS1hdXRvIG1iLTQgYm9yZGVyIGJvcmRlci1ncmF5LTIwMFwiIC8vIEFkZGVkIGJvcmRlclxuICAgICAgPlxuICAgICAgICB7bWVzc2FnZXMubGVuZ3RoID09PSAwICYmICFpc0xvYWRpbmcgJiYgIWVycm9yICYmIChcbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHRleHQtZ3JheS01MDAgdGV4dC1zbVwiPkFzayBtZSB0byBtYW5hZ2UgeW91ciBjYWxlbmRhciBldmVudHMhPC9wPlxuICAgICAgICApfVxuICAgICAgICB7bWVzc2FnZXMubWFwKChtc2cpID0+IChcbiAgICAgICAgICAgIC8vIFN0eWxlcyBwcmV2aW91c2x5IGZyb20gLm1lc3NhZ2UgYW5kIHNwZWNpZmljIHR5cGVzXG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAga2V5PXttc2cuaWR9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgbWItMyBwLTMgcm91bmRlZC14bCBtYXgtdy1bODAlXSBicmVhay13b3JkcyAke1xuICAgICAgICAgICAgICAgICAgICBtc2cuc2VuZGVyID09PSAndXNlcidcbiAgICAgICAgICAgICAgICAgICAgPyAnYmctYmx1ZS01MDAgdGV4dC13aGl0ZSBtbC1hdXRvJyAvLyAudXNlciBzdHlsZXNcbiAgICAgICAgICAgICAgICAgICAgOiAnYmctZ3JheS02MDAgdGV4dC13aGl0ZSBtci1hdXRvJyAvLyAuYm90IHN0eWxlcyBcbiAgICAgICAgICAgICAgICB9ICR7bXNnLmlzU3RyZWFtaW5nID8gJ2JvcmRlci1sLTQgYm9yZGVyLXllbGxvdy00MDAnIDogJyd9ICR7bXNnLmlzUHJvY2Vzc2luZyA/ICdib3JkZXItbC00IGJvcmRlci1ibHVlLTQwMCcgOiAnJ31gfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHttc2cuaGFzRXZlbnRzID8gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndoaXRlc3BhY2UtcHJlLXdyYXBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHttc2cudGV4dC5zcGxpdCgnXFxuJykubWFwKChsaW5lLCBpbmRleCkgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYga2V5PXtpbmRleH0gY2xhc3NOYW1lPXtgJHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZS5zdGFydHNXaXRoKCfwn5OFJykgfHwgbGluZS5zdGFydHNXaXRoKCfwn5OGJykgPyAnZm9udC1ib2xkJyA6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWB9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bGluZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICAgICAgICAgICAge21zZy5pc1N0cmVhbWluZyAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaW5saW5lLWJsb2NrIHctMiBoLTQgbWwtMSBiZy15ZWxsb3ctNDAwIGFuaW1hdGUtcHVsc2VcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAge21zZy5pc1Byb2Nlc3NpbmcgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlubGluZS1ibG9jayB3LTIgaC00IG1sLTEgYmctYmx1ZS00MDAgYW5pbWF0ZS1wdWxzZVwiPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2hpdGVzcGFjZS1wcmUtd3JhcFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAge21zZy50ZXh0fVxuICAgICAgICAgICAgICAgICAgICAgICAge21zZy5pc1N0cmVhbWluZyAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaW5saW5lLWJsb2NrIHctMiBoLTQgbWwtMSBiZy15ZWxsb3ctNDAwIGFuaW1hdGUtcHVsc2VcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAge21zZy5pc1Byb2Nlc3NpbmcgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlubGluZS1ibG9jayB3LTIgaC00IG1sLTEgYmctYmx1ZS00MDAgYW5pbWF0ZS1wdWxzZVwiPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSl9XG5cbiAgICAgICAgIHsvKiBMb2FkaW5nIEluZGljYXRvciBpbnNpZGUgY2hhdGJveCAqL31cbiAgICAgICAge2lzTG9hZGluZyAmJiAoXG4gICAgICAgICAgICAvLyBTdHlsZXMgcHJldmlvdXNseSBmcm9tIC5sb2FkaW5nIGFuZCAuZG90XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1zdGFydCBpdGVtcy1jZW50ZXIgaC0xMCBteS0yXCI+XG4gICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBzcGFjZS14LTEuNSBwLTIgYmctZ3JheS02MDAgcm91bmRlZC1mdWxsXCI+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInctMiBoLTIgYmctd2hpdGUgcm91bmRlZC1mdWxsIGFuaW1hdGUtYm91bmNlIFthbmltYXRpb24tZGVsYXk6LTAuM3NdXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ3LTIgaC0yIGJnLXdoaXRlIHJvdW5kZWQtZnVsbCBhbmltYXRlLWJvdW5jZSBbYW5pbWF0aW9uLWRlbGF5Oi0wLjE1c11cIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInctMiBoLTIgYmctd2hpdGUgcm91bmRlZC1mdWxsIGFuaW1hdGUtYm91bmNlXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApfVxuXG4gICAgICAgIHsvKiBFcnJvciBtZXNzYWdlIGluc2lkZSBjaGF0Ym94ICovfVxuICAgICAgICB7ZXJyb3IgJiYgKFxuICAgICAgICAgICAgIC8vIFN0eWxlcyBwcmV2aW91c2x5IGZyb20gLmVycm9yXG4gICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYi0zIHAtMyByb3VuZGVkLXhsIG1heC13LVs4MCVdIGJnLXJlZC01MDAgdGV4dC13aGl0ZSBteC1hdXRvIHRleHQtY2VudGVyIHRleHQtc21cIj5cbiAgICAgICAgICAgICAgICAge2Vycm9yfVxuICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApfVxuICAgICAgPC9kaXY+XG5cbiAgICAgIHsvKiBTdHlsZXMgcHJldmlvdXNseSBmcm9tIC5pbnB1dC1jb250YWluZXIgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLWdyYXktMTAwIHAtMiByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIgdHJhbnNpdGlvbi1zaGFkb3cgZHVyYXRpb24tMzAwIGZvY3VzLXdpdGhpbjpyaW5nLTIgZm9jdXMtd2l0aGluOnJpbmctYmx1ZS01MDAgYm9yZGVyIGJvcmRlci1ncmF5LTIwMFwiPlxuICAgICAgICB7LyogU3R5bGVzIHByZXZpb3VzbHkgZnJvbSBpbnB1dCAqL31cbiAgICAgICAgPGlucHV0XG4gICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiQXNrIGFib3V0IHlvdXIgY2FsZW5kYXIuLi5cIlxuICAgICAgICAgIHZhbHVlPXtpbnB1dH1cbiAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlSW5wdXRDaGFuZ2V9XG4gICAgICAgICAgb25LZXlEb3duPXtoYW5kbGVLZXlEb3dufVxuICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmd9XG4gICAgICAgICAgY2xhc3NOYW1lPVwiYmctdHJhbnNwYXJlbnQgYm9yZGVyLW5vbmUgdGV4dC1ncmF5LTgwMCBmbGV4LWdyb3cgdGV4dC1iYXNlIHAtMiBvdXRsaW5lLW5vbmUgcGxhY2Vob2xkZXItZ3JheS01MDAgZGlzYWJsZWQ6b3BhY2l0eS02MFwiXG4gICAgICAgIC8+XG4gICAgICAgIHsvKiBTdHlsZXMgcHJldmlvdXNseSBmcm9tIC5zZW5kLWljb24gKi99XG4gICAgICAgIDxidXR0b25cbiAgICAgICAgICBvbkNsaWNrPXtzZW5kTWVzc2FnZX1cbiAgICAgICAgICBkaXNhYmxlZD17aXNMb2FkaW5nIHx8ICFpbnB1dC50cmltKCl9XG4gICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC0yeGwgcC0yIHJvdW5kZWQtZnVsbCB0ZXh0LWJsdWUtNTAwIGJnLXRyYW5zcGFyZW50IGJvcmRlci1ub25lIHRyYW5zaXRpb24tdHJhbnNmb3JtIGR1cmF0aW9uLTMwMCBob3ZlcjpzY2FsZS0xMTAgaG92ZXI6YmctYmx1ZS0xMDAgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMSBmb2N1czpyaW5nLWJsdWUtNTAwIGRpc2FibGVkOm9wYWNpdHktNTAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkIGRpc2FibGVkOmhvdmVyOnNjYWxlLTEwMCBkaXNhYmxlZDpob3ZlcjpiZy10cmFuc3BhcmVudFwiXG4gICAgICAgICAgYXJpYS1sYWJlbD1cIlNlbmQgbWVzc2FnZVwiXG4gICAgICAgID5cbiAgICAgICAgICA8RmlTZW5kIC8+XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBDaGF0O1xuXG4vLyBBZGQgc2VydmVyLXNpZGUgYXV0aGVudGljYXRpb24gY2hlY2tcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXJ2ZXJTaWRlUHJvcHMoY29udGV4dCkge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2VydmVyU2Vzc2lvbihjb250ZXh0LnJlcSwgY29udGV4dC5yZXMsIGF1dGhPcHRpb25zKTtcbiAgXG4gIC8vIElmIG5vIHNlc3Npb24gZXhpc3RzLCByZWRpcmVjdCB0byBob21lIHBhZ2VcbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgIGRlc3RpbmF0aW9uOiAnLycsXG4gICAgICAgIHBlcm1hbmVudDogZmFsc2UsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbiAgXG4gIC8vIElmIHNlc3Npb24gZXhpc3RzLCBqdXN0IHJldHVybiBlbXB0eSBwcm9wc1xuICByZXR1cm4ge1xuICAgIHByb3BzOiB7fSxcbiAgfTtcbn0iXSwibmFtZXMiOlsiUmVhY3QiLCJ1c2VTdGF0ZSIsInVzZVJlZiIsInVzZUVmZmVjdCIsIkZpU2VuZCIsIkZpTWVudSIsInVzZVNlc3Npb24iLCJ1c2VSb3V0ZXIiLCJDaGF0IiwiZGF0YSIsInNlc3Npb24iLCJzdGF0dXMiLCJyb3V0ZXIiLCJtZXNzYWdlcyIsInNldE1lc3NhZ2VzIiwiaW5wdXQiLCJzZXRJbnB1dCIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsImVycm9yIiwic2V0RXJyb3IiLCJjaGF0Qm94UmVmIiwiY3VycmVudEJvdE1lc3NhZ2VJZFJlZiIsImFjY3VtdWxhdGVkVGV4dFJlZiIsImlzRmlyc3RNZXNzYWdlU2VudCIsInNldElzRmlyc3RNZXNzYWdlU2VudCIsInB1c2giLCJzdHJlYW1pbmdSZXNwb25zZSIsInNldFN0cmVhbWluZ1Jlc3BvbnNlIiwiaXNTdHJlYW1pbmciLCJzZXRJc1N0cmVhbWluZyIsInNlbmRNZXNzYWdlIiwidHJpbSIsIm5ld1VzZXJNZXNzYWdlIiwiaWQiLCJEYXRlIiwibm93IiwidGV4dCIsInNlbmRlciIsInByZXYiLCJjdXJyZW50IiwidGVtcEJvdElkIiwiY29uc29sZSIsImxvZyIsImVuY29kZWRNZXNzYWdlIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZXZlbnRTb3VyY2VVcmwiLCJldmVudFNvdXJjZSIsIkV2ZW50U291cmNlIiwiY29ubmVjdGlvblRpbWVvdXQiLCJzZXRUaW1lb3V0IiwicmVhZHlTdGF0ZSIsImNsb3NlIiwibGVuZ3RoIiwiZmluYWxpemVCb3RNZXNzYWdlIiwib25tZXNzYWdlIiwiZXZlbnQiLCJjbGVhclRpbWVvdXQiLCJKU09OIiwicGFyc2UiLCJwYXJzZUVycm9yIiwidHlwZSIsImNvbnRlbnQiLCJ1cGRhdGVkTWVzc2FnZXMiLCJtYXAiLCJtc2ciLCJoYXNFdmVudHMiLCJpbmNsdWRlcyIsImN1cnJlbnRUZXh0IiwiaXNQcm9jZXNzaW5nIiwic3RhdGVFcnJvciIsImN1cnJlbnRNc2ciLCJmaW5kIiwibSIsIkVycm9yIiwiZXJyIiwib25lcnJvciIsImZpbmFsVGV4dCIsInVwZGF0ZUVycm9yIiwiZXJyb3JVcGRhdGVFcnJvciIsImhhbmRsZUlucHV0Q2hhbmdlIiwiZSIsInRhcmdldCIsInZhbHVlIiwiaGFuZGxlS2V5RG93biIsImtleSIsInNoaWZ0S2V5IiwicHJldmVudERlZmF1bHQiLCJzY3JvbGxUb3AiLCJzY3JvbGxIZWlnaHQiLCJkaXYiLCJjbGFzc05hbWUiLCJidXR0b24iLCJ1c2VyIiwiaW1nIiwic3JjIiwiaW1hZ2UiLCJhbHQiLCJzcGFuIiwibmFtZSIsInJlZiIsInAiLCJzcGxpdCIsImxpbmUiLCJpbmRleCIsInN0YXJ0c1dpdGgiLCJwbGFjZWhvbGRlciIsIm9uQ2hhbmdlIiwib25LZXlEb3duIiwiZGlzYWJsZWQiLCJvbkNsaWNrIiwiYXJpYS1sYWJlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./pages/chat.js\n"));

/***/ })

});